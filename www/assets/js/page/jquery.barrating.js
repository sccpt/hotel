(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof module==="object"&&module.exports){module.exports=a(require("jquery"))}else{a(jQuery)}}}(function(a){var b=(function(){function c(){var z=this;var F=function(){var G=["br-wrapper"];if(z.options.theme!==""){G.push("br-theme-"+z.options.theme)}z.$elem.wrap(a("<div />",{"class":G.join(" ")}))};var E=function(){z.$elem.unwrap()};var m=function(G){if(a.isNumeric(G)){G=Math.floor(G)}return a('option[value="'+G+'"]',z.$elem)};var q=function(){var G=z.options.initialRating;if(!G){return a("option:selected",z.$elem)}return m(G)};var p=function(){var G=z.$elem.find('option[value="'+z.options.emptyValue+'"]');if(!G.length&&z.options.allowEmpty){G=a("<option />",{value:z.options.emptyValue});return G.prependTo(z.$elem)}return G};var o=function(H){var G=z.$elem.data("barrating");if(typeof H!=="undefined"){return G[H]}return G};var A=function(G,H){if(H!==null&&typeof H==="object"){z.$elem.data("barrating",H)}else{z.$elem.data("barrating")[G]=H}};var y=function(){var H=q();var G=p();var M=H.val();var L=H.data("html")?H.data("html"):H.text();var I=(z.options.allowEmpty!==null)?z.options.allowEmpty:!!G.length;var K=(G.length)?G.val():null;var J=(G.length)?G.text():null;A(null,{userOptions:z.options,ratingValue:M,ratingText:L,originalRatingValue:M,originalRatingText:L,allowEmpty:I,emptyRatingValue:K,emptyRatingText:J,readOnly:z.options.readonly,ratingMade:false})};var v=function(){z.$elem.removeData("barrating")};var t=function(){return o("ratingText")};var u=function(){return o("ratingValue")};var i=function(){var G=a("<div />",{"class":"br-widget"});z.$elem.find("option").each(function(){var K,J,I,H;K=a(this).val();if(K!==o("emptyRatingValue")){J=a(this).text();I=a(this).data("html");if(I){J=I}H=a("<a />",{href:"#","data-rating-value":K,"data-rating-text":J,html:(z.options.showValues)?J:""});G.append(H)}});if(z.options.showSelectedRating){G.append(a("<div />",{text:"","class":"br-current-rating"}))}if(z.options.reverse){G.addClass("br-reverse")}if(z.options.readonly){G.addClass("br-readonly")}return G};var s=function(){if(o("userOptions").reverse){return"nextAll"}else{return"prevAll"}};var B=function(G){m(G).prop("selected",true);if(o("userOptions").triggerChange){z.$elem.change()}};var w=function(){a("option",z.$elem).prop("selected",function(){return this.defaultSelected});if(o("userOptions").triggerChange){z.$elem.change()}};var D=function(G){G=G?G:t();if(G==o("emptyRatingText")){G=""}if(z.options.showSelectedRating){z.$elem.parent().find(".br-current-rating").text(G)}};var n=function(G){return Math.round(((Math.floor(G*10)/10)%1)*100)};var x=function(){z.$widget.find("a").removeClass(function(H,G){return(G.match(/(^|\s)br-\S+/g)||[]).join(" ")})};var d=function(){var G=z.$widget.find('a[data-rating-value="'+u()+'"]');var L=o("userOptions").initialRating;var J=a.isNumeric(u())?u():0;var K=n(L);var H,I;x();G.addClass("br-selected br-current")[s()]().addClass("br-selected");if(!o("ratingMade")&&a.isNumeric(L)){if((L<=J)||!K){return}H=z.$widget.find("a");I=(G.length)?G[(o("userOptions").reverse)?"prev":"next"]():H[(o("userOptions").reverse)?"last":"first"]();I.addClass("br-fractional");I.addClass("br-fractional-"+K)}};var r=function(G){if(!o("allowEmpty")||!o("userOptions").deselectable){return false}return(u()==G.attr("data-rating-value"))};var e=function(G){G.on("click.barrating",function(I){var H=a(this),J=o("userOptions"),L,K;I.preventDefault();L=H.attr("data-rating-value");K=H.attr("data-rating-text");if(r(H)){L=o("emptyRatingValue");K=o("emptyRatingText")}A("ratingValue",L);A("ratingText",K);A("ratingMade",true);B(L);D(K);d();J.onSelect.call(z,u(),t(),I);return false})};var g=function(G){G.on("mouseenter.barrating",function(){var H=a(this);x();H.addClass("br-active")[s()]().addClass("br-active");D(H.attr("data-rating-text"))})};var h=function(G){z.$widget.on("mouseleave.barrating blur.barrating",function(){D();d()})};var l=function(G){G.on("touchstart.barrating",function(H){H.preventDefault();H.stopPropagation();a(this).click()})};var k=function(G){G.on("click.barrating",function(H){H.preventDefault()})};var f=function(G){e(G);if(z.options.hoverState){g(G);h(G)}};var j=function(G){G.off(".barrating")};var C=function(H){var G=z.$widget.find("a");if(o("userOptions").fastClicks){l(G)}if(H){j(G);k(G)}else{f(G)}};this.show=function(){if(o()){return}F();y();z.$widget=i();z.$widget.insertAfter(z.$elem);d();D();C(z.options.readonly);z.$elem.hide()};this.readonly=function(G){if(typeof G!=="boolean"||o("readOnly")==G){return}C(G);A("readOnly",G);z.$widget.toggleClass("br-readonly")};this.set=function(H){var G=o("userOptions");if(z.$elem.find('option[value="'+H+'"]').length===0){return}A("ratingValue",H);A("ratingText",z.$elem.find('option[value="'+H+'"]').text());A("ratingMade",true);B(u());D(t());d();if(!G.silent){G.onSelect.call(this,u(),t())}};this.clear=function(){var G=o("userOptions");A("ratingValue",o("originalRatingValue"));A("ratingText",o("originalRatingText"));A("ratingMade",false);w();D(t());d();G.onClear.call(this,u(),t())};this.destroy=function(){var I=u();var H=t();var G=o("userOptions");j(z.$widget.find("a"));z.$widget.remove();v();E();z.$elem.show();G.onDestroy.call(this,I,H)}}c.prototype.init=function(e,d){this.$elem=a(d);this.options=a.extend({},a.fn.barrating.defaults,e);return this.options};return c})();a.fn.barrating=function(c,d){return this.each(function(){var e=new b();if(!a(this).is("select")){a.error("Sorry, this plugin only works with select fields.")}if(e.hasOwnProperty(c)){e.init(d,this);if(c==="show"){return e.show(d)}else{if(e.$elem.data("barrating")){e.$widget=a(this).next(".br-widget");return e[c](d)}}}else{if(typeof c==="object"||!c){d=c;e.init(d,this);return e.show()}else{a.error("Method "+c+" does not exist on jQuery.barrating")}}})};a.fn.barrating.defaults={theme:"",initialRating:null,allowEmpty:null,emptyValue:"",showValues:false,showSelectedRating:true,deselectable:true,reverse:false,readonly:false,fastClicks:true,hoverState:true,silent:false,triggerChange:true,onSelect:function(e,d,c){},onClear:function(d,c){},onDestroy:function(d,c){}};a.fn.barrating.BarRating=b}));