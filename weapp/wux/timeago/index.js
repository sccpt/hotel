"use strict";var _baseComponent=_interopRequireDefault(require("../helpers/baseComponent")),_classNames=_interopRequireDefault(require("../helpers/classNames")),_index=require("./core/index"),_index2=_interopRequireDefault(require("./locales/index"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(0,_baseComponent.default)({properties:{prefixCls:{type:String,value:"wux-timeago"},to:{type:null,value:null,observer:function(e){var t=this.data,r=t.from,a=t.lang;this.updated(e,r,a)}},from:{type:null,value:null,observer:function(e){var t=this.data,r=t.to,a=t.lang;this.updated(r,e,a)}},refreshable:{type:Boolean,value:!1,observer:function(e){var t=this.data,r=t.to,a=t.from,i=t.lang;this.updated(r,a,i,!0)}},lang:{type:String,value:"zh_CN",observer:function(e){var t=this.data,r=t.to,a=t.from;this.updated(r,a,e,!0)}}},data:{currentTo:null,currentFrom:null,timeago:null},methods:{updated:function(r,a,i,e){var n=this;if(this.clearTimer(),r!==this.data.currentTo||a!==this.data.currentFrom||e){var t=(0,_index.diff)(r,a),u=(0,_index.format)(t,_index2.default[i]);this.setData({currentTo:r,currentFrom:a,timeago:u},function(){if(n.data.refreshable&&!n.data.from){var e=(0,_index.diff)(r,a,"minute"),t=(e<1?1:e<60&&30)||e<180&&300||3600;n.timeout=setTimeout(function(){n.updated(r,n.getNow(),i)},1e3*t)}})}},clearTimer:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},getNow:function(){var e=this.data.from;return e?e&&(0,_index.parse)(e):new Date}},detached:function(){this.clearTimer()}});